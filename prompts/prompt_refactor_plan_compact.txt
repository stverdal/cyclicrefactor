# Compact Planning Prompt (for low-VRAM)

Create a refactoring plan for this cyclic dependency.

## Cycle: {id}
Graph: {graph}
Files: {files}

## Description
{description}

## Source Code
{file_snippets}

---

## EXAMPLE

**Input:** OrderService → UserService → OrderService

**Output:**
```json
{
  "strategy": "interface_extraction",
  "summary": "Extract IOrderInfo interface. UserService depends on interface, OrderService implements it.",
  "new_files": [{"path": "Interfaces/IOrderInfo.cs", "purpose": "Interface with GetOrderCount method"}],
  "file_changes": [
    {
      "path": "OrderService.cs",
      "order": 1,
      "changes": ["Add IOrderInfo to class declaration"],
      "reason": "Implements the interface"
    },
    {
      "path": "UserService.cs",
      "order": 2,
      "changes": ["Replace OrderService with IOrderInfo", "Update imports"],
      "reason": "Breaks the cycle by depending on abstraction"
    }
  ],
  "execution_order": ["Interfaces/IOrderInfo.cs", "OrderService.cs", "UserService.cs"]
}
```

---

## Output (JSON)

```json
{
  "strategy": "<interface_extraction|dependency_inversion|shared_module>",
  "summary": "<brief approach>",
  "new_files": [{"path": "<new file>", "purpose": "<what it contains>"}],
  "file_changes": [
    {
      "path": "<file>",
      "order": 1,
      "changes": ["<change 1>", "<change 2>"],
      "reason": "<why>"
    }
  ],
  "execution_order": ["<file1>", "<file2>"]
}
```

## ✓ VERIFY
□ New files listed in execution_order FIRST
□ Each change helps break the cycle

Output ONLY JSON.
